@model LaPizzaria.ViewModels.HomeIndexViewModel
@{ ViewData["Title"] = "Trang Chính"; }

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800;900&family=Inter:wght@400;600&display=swap" rel="stylesheet">

<!-- Hero Section -->
<section class="hero-banner text-center d-flex flex-column align-items-center justify-content-center">
    <h1 class="brand-hero-title">La Pizzaria</h1>
    <p class="brand-hero-sub">Hương vị đích thực từ lò nướng Ý</p>
    <div class="mt-3">
        <a asp-controller="Order" asp-action="ScanQr" class="btn btn-brand-primary btn-lg me-2">Đặt món ngay</a>
        <a asp-controller="Product" asp-action="Index" class="btn btn-outline-light btn-lg">Xem menu</a>
    </div>
</section>

<style>
    .hero-banner {
        min-height: 60vh;
        background: linear-gradient(rgba(0,0,0,.35), rgba(0,0,0,.35)), url('https://images.unsplash.com/photo-1548365328-9f547fb09530?q=80&w=1500&auto=format&fit=crop') center/cover no-repeat;
        color: var(--light-text-color);
        padding: 80px 16px;
    }
    .brand-hero-title {
        font-family: 'Playfair Display', serif;
        font-weight: 900;
        font-size: clamp(48px, 8vw, 96px);
        letter-spacing: 1px;
        margin: 0;
        text-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .brand-hero-sub {
        font-family: 'Inter', sans-serif;
        font-size: clamp(16px, 2vw, 24px);
        opacity: .9;
        margin-top: 8px;
    }
</style>

<!-- Product Showcase Section -->
<div class="container my-5">
    <h2 class="text-center mb-4">Các món đặc biệt của chúng tôi</h2>

    <h4 class="mb-3">Món bán chạy</h4>
    <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3">
        @foreach (var p in Model.TopProducts)
        {
            <div class="col">
                <div class="card h-100 shadow-sm">
                    <img src="@(!string.IsNullOrEmpty(p.ImageUrl) ? p.ImageUrl : "https://via.placeholder.com/600x400?text=Pizza")" class="card-img-top" alt="@p.Name">
                    <div class="card-body">
                        <h5 class="card-title">@p.Name</h5>
                        <p class="card-text mb-1"><span class="badge bg-success">Đặt @p.TotalOrdered lần</span></p>
                        <p class="card-text text-primary fw-bold">@p.Price.ToString("N0") đ</p>
                        <a asp-controller="Product" asp-action="Index" class="btn btn-sm btn-outline-primary">Xem trong menu</a>
                    </div>
                </div>
            </div>
        }
    </div>

    <hr class="my-5" />
    <h4 class="mb-3">Combo đang có</h4>
    <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-3">
        @foreach (var c in Model.ActiveCombos)
        {
            var firstImage = c.Items.FirstOrDefault(i => i.Product != null && !string.IsNullOrEmpty(i.Product.ImageUrl))?.Product?.ImageUrl
                ?? "https://via.placeholder.com/600x400?text=Combo";
            <div class="col">
                <div class="card h-100 shadow-sm">
                    <img src="@firstImage" class="card-img-top" alt="@c.Name">
                    <div class="card-body">
                        <h5 class="card-title">@c.Name</h5>
                        @if (!string.IsNullOrEmpty(c.Description))
                        {
                            <p class="card-text">@c.Description</p>
                        }
                        <p class="card-text text-danger fw-bold">Giảm @c.DiscountAmount.ToString("N0") đ @(c.DiscountPercent.HasValue ? $" / {c.DiscountPercent}%" : "")</p>
                        <div class="small text-muted">
                            gồm: @string.Join(", ", c.Items.Where(i=>i.Product!=null).Select(i => $"{i.Product!.Name} x{i.MinQuantity}"))
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>
